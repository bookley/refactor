{"version":3,"sources":["webpack:///webpack/bootstrap 63ce697ff4cf35bb6b30","webpack:///./client/engine/engine.ts","webpack:///./client/engine/core/graphics.ts","webpack:///./client/engine/core/assets/assetCollection.ts","webpack:///./client/engine/core/helpers/MeshHelper.ts","webpack:///./client/engine/core/mesh.ts","webpack:///./client/engine/core/filetypes/objloader.ts","webpack:///./client/engine/core/debugLine.ts","webpack:///./client/engine/core/texture.ts","webpack:///./client/engine/core/shaders.ts","webpack:///./client/engine/core/tileMapRenderer.ts","webpack:///./client/engine/core/context.ts","webpack:///./client/engine/core/assets/assetLoader.ts","webpack:///./client/engine/core/assets/asset.ts","webpack:///./client/engine/camera/camera.ts","webpack:///./client/engine/input/input.ts","webpack:///./client/engine/input/mousePosition.ts","webpack:///./client/engine/camera/behaviours/arcballBehaviour.ts","webpack:///./client/engine/game/scene.ts","webpack:///./client/engine/game/entities/tile.ts","webpack:///./client/engine/game/gameObject.ts","webpack:///./client/engine/game/tileMap.ts","webpack:///./client/engine/game/entities/peon.ts","webpack:///./client/engine/game/ray.ts","webpack:///./client/engine/core/imageMap.ts","webpack:///./client/engine/game/scenegraph.ts","webpack:///./client/engine/camera/behaviours/cameraClickPickerBehaviour.ts"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 63ce697ff4cf35bb6b30","/**\r\n * Created by Jamie on 03-Apr-15.\r\n */\r\n\r\nvar assetUrls = [\r\n    {\r\n        url: \"assets/shaders/texturedFrag.frag\",\r\n        name: \"texturedFrag\",\r\n        type: \"shader\"\r\n    },\r\n    {\r\n        url: \"assets/shaders/texturedVert.vert\",\r\n        name: \"texturedVert\",\r\n        type: \"shader\"\r\n    },\r\n    {\r\n        url: \"assets/shaders/instancedVert.vert\",\r\n        name: \"instancedVert\",\r\n        type: \"shader\"\r\n    },\r\n    {\r\n        url: \"assets/shaders/debugFrag.frag\",\r\n        name: \"debugFrag\",\r\n        type: \"shader\"\r\n    },\r\n    {\r\n        url: \"assets/shaders/debugVert.vert\",\r\n        name: \"debugVert\",\r\n        type: \"shader\"\r\n    },\r\n    {\r\n        url: \"assets/models/man.obj\",\r\n        name: \"man\",\r\n        type: \"mesh\"\r\n    },\r\n    {\r\n        url: \"assets/textures/mantex.png\",\r\n        name: \"mantexture\",\r\n        type: \"texture\"\r\n    },\r\n    {\r\n        url: \"assets/textures/wood.png\",\r\n        name:\"exclamation\",\r\n        type:\"texture\"\r\n    },\r\n    {\r\n        url: \"assets/textures/tileMap2.png\",\r\n        name:\"tileMap\",\r\n        type:\"texture\"\r\n    },\r\n    {\r\n        url:\"assets/textures/selectTile.png\",\r\n        name:\"selectTile\",\r\n        type:\"texture\"\r\n    },\r\n    {\r\n        url:\"assets/text/test.png\",\r\n        name:\"test\",\r\n        type:\"texture\"\r\n    },\r\n    {\r\n        url:\"assets/text/test.fnt\",\r\n        name:\"test_fnt\",\r\n        type:\"fnt\"\r\n    },\r\n]\r\n\r\nimport {Graphics} from \"./core/graphics\";\r\nimport {AssetLoader} from \"./core/assets/assetLoader\";\r\n\r\nimport {Camera} from \"./camera/camera\";\r\nimport {InputListener} from \"./input/input\";\r\nimport {Scene} from \"./game/scene\";\r\nimport {Scenegraph} from \"./game/scenegraph\";\r\nimport {CameraClickPickerBehaviour} from \"./camera/behaviours/cameraClickPickerBehaviour\";\r\n\r\n\r\nclass Engine {\r\n    canvas:HTMLCanvasElement;\r\n    camera:Camera;\r\n    input:InputListener;\r\n\r\n    graphics:Graphics;\r\n    assetLoader:AssetLoader;\r\n\r\n    sceneGraph:Scenegraph;\r\n    scene:Scene;\r\n\r\n    ready:boolean;\r\n\r\n    /**\r\n     *\r\n     * @param canvas The name of the canvas element to use for the renderer\r\n     * @param sceneClass\r\n     */\r\n    constructor(canvas:string, sceneClass) {\r\n        var self = this;\r\n        this.ready = false;\r\n\r\n        //Dep 1\r\n        this.canvas = <HTMLCanvasElement>document.getElementById(canvas);\r\n\r\n        //Dep 2\r\n        this.camera = new Camera(this.canvas.width, this.canvas.height, 45, 1, 100);\r\n\r\n        //Dep 3\r\n        this.graphics = new Graphics(this.canvas);\r\n\r\n        //Dep 4\r\n        this.input = new InputListener(this.canvas);\r\n        this.input.ControlCamera(this.camera);\r\n\r\n        //Dep 5\r\n        this.sceneGraph = new Scenegraph();\r\n\r\n        //Dep 6\r\n        this.scene = new sceneClass(this);\r\n\r\n        //Dep 7\r\n        var pickingBehaviour = new CameraClickPickerBehaviour(this.sceneGraph, this.camera);\r\n        pickingBehaviour.setViewportDimensions(this.graphics.viewportWidth, this.graphics.viewportHeight);\r\n        this.input.setOnCameraClickBehaviour(pickingBehaviour);\r\n\r\n        //Dep 8\r\n        this.assetLoader = new AssetLoader(assetUrls);\r\n        this.assetLoader.loadAll().then(function () {\r\n            self.ready = true;\r\n            self.graphics.setAssets(self.assetLoader);\r\n            self.loadShaders();\r\n            engine.input.setMouseMoveListener(self.scene);\r\n            self.scene.onStart();\r\n        }).catch(function(err){\r\n            console.error(err.stack);\r\n        });\r\n    }\r\n\r\n    loadShaders(){\r\n        this.graphics.createShader(\"TexturedShader\", \"texturedVert\", \"texturedFrag\",\r\n            [\"aVertexPosition\", \"aVertexNormal\", \"aTexCoords\"],\r\n            [\"uMVMatrix\", \"uPMatrix\", \"uCMatrix\", \"lightDirection\"]);\r\n\r\n\r\n        this.graphics.createShader(\"DebugShader\", \"debugVert\", \"debugFrag\",\r\n            [\"aVertexPosition\", \"aVertexColour\"],\r\n            [\"uMVMatrix\", \"uPMatrix\", \"uCMatrix\"]);\r\n\r\n\r\n\r\n        this.graphics.createShader(\"InstancedShader\", \"instancedVert\", \"texturedFrag\",\r\n            [\"aVertexPosition\", \"aVertexNormal\", \"aTexCoords\"],\r\n            [\"uPMatrix\", \"uCMatrix\", \"lightDirection\"]);\r\n\r\n    }\r\n}\r\n\r\nvar engine = new Engine(\"mycanvas\", Scene);\r\n\r\nfunction loop(){\r\n    if(engine.ready) {\r\n        engine.input.Update();\r\n        engine.sceneGraph.update(0);\r\n\r\n        engine.graphics.useShader(\"InstancedShader\");\r\n        engine.graphics.instancedDraw(engine.camera);\r\n\r\n        engine.graphics.useShader(\"TexturedShader\");\r\n        engine.graphics.draw(engine.camera, engine.sceneGraph);\r\n\r\n        engine.graphics.useShader(\"DebugShader\");\r\n        engine.graphics.debugDraw(engine.camera, engine.sceneGraph);\r\n\r\n    }\r\n    window.requestAnimationFrame(loop);\r\n}\r\nwindow.requestAnimationFrame(loop);\r\n\r\nexport = Engine;\n\n\n// WEBPACK FOOTER //\n// ./client/engine/engine.ts","\r\nimport Shader = require(\"./shaders\");\r\nimport AssetCollection = require(\"./assets/assetCollection\");\r\nimport TileMapRenderer = require(\"./tileMapRenderer\");\r\nimport {Context, DefaultContext} from \"./context\";\r\nimport {AssetLoader} from \"./assets/assetLoader\";\r\n/**\r\n * Responsible for initializing and maintaining the main WebGL context\r\n */\r\nexport class Graphics {\r\n    static DRAW_DEBUG_INFO:boolean = false;\r\n    static DEFAULT_LIGHT_DIRECTION:number[] = [0, -1, 0];\r\n    static DEFAULT_CLEAR_COLOR = {\r\n        r:1,\r\n        g:1,\r\n        b:1,\r\n        a:1\r\n    };\r\n\r\n    ctx:WebGLRenderingContext;\r\n    viewportWidth:number;\r\n    viewportHeight:number;\r\n\r\n    _lightDir:number[];\r\n    currentShader:Shader;\r\n    pMatrix:Float32Array;\r\n\r\n    assetCollection:AssetCollection;\r\n    tileMapRenderer:TileMapRenderer;\r\n\r\n    context:Context;\r\n\r\n\r\n    constructor(canvas:HTMLCanvasElement) {\r\n        this.initGL(canvas)\r\n        this.assetCollection = new AssetCollection(this.ctx);\r\n        this.tileMapRenderer = new TileMapRenderer(this.ctx);\r\n    }\r\n\r\n    private initGL(canvas:HTMLCanvasElement):void{\r\n        this.context = new DefaultContext(canvas);\r\n        this.ctx = canvas.getContext(\"webgl\");\r\n\r\n        this.viewportWidth = canvas.width;\r\n        this.viewportHeight = canvas.height;\r\n\r\n        if (!this.ctx) alert(\"Error initializing WebGL context\");\r\n        this._lightDir = Graphics.DEFAULT_LIGHT_DIRECTION;\r\n        this.context.clearColor(Graphics.DEFAULT_CLEAR_COLOR.r, Graphics.DEFAULT_CLEAR_COLOR.g, Graphics.DEFAULT_CLEAR_COLOR.b, Graphics.DEFAULT_CLEAR_COLOR.a);\r\n        this.context.setDepthTestEnabled(true)\r\n    }\r\n\r\n    setBackground(r, g, b) {\r\n        this.context.clearColor(r, g, b, 1.0);\r\n    }\r\n\r\n    setAssets(assetLoader:AssetLoader) {\r\n        this.assetCollection.setAssets(assetLoader);\r\n    }\r\n\r\n    createShader(shaderName:string, vShaderName:string, fShaderName:string, attributes:string[], uniforms:string[]) {\r\n        this.assetCollection.createShader(shaderName, vShaderName, fShaderName, attributes, uniforms);\r\n    }\r\n\r\n    useShader(shaderName) {\r\n        this.currentShader = this.assetCollection.getShader(shaderName);\r\n        this.currentShader.Activate();\r\n    }\r\n\r\n    setLightDir(vec) {\r\n        this._lightDir = vec;\r\n    }\r\n\r\n    /**\r\n     * Draws the entities in the scenegraph\r\n     * @param camera The camera to use when rendering the scene\r\n     * @param scenegraph The scenegraph to interate over\r\n     * @constructor\r\n     */\r\n    draw(camera, scenegraph) {\r\n        this.context.setVertexAttribArrayEnabled(3, false);\r\n        /* Mesh position */\r\n        this.currentShader.passMatrix(\"uPMatrix\", camera.getPerspectiveMatrix());\r\n        this.currentShader.passVec3(\"lightDirection\", this._lightDir);\r\n\r\n        if (!camera) throw new Error(\"Can't draw if a camera isn't set\");\r\n        this.currentShader.passMatrix(\"uCMatrix\", camera.getMatrix());\r\n        this.ctx.enable(this.ctx.DEPTH_TEST);\r\n        for (var i = 0; i < scenegraph.graph.length; i++) {\r\n            var entity = scenegraph.graph[i];\r\n            if(!entity.visible) continue;\r\n\r\n            var modelMatrix = entity.getMatrix();\r\n            if (entity.texture != null) {\r\n                entity.texture.Bind();\r\n            }\r\n            entity.mesh.Draw(this.currentShader, modelMatrix);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Renders the debug information in the given scenegraph, and the normals of the entities in the scenegraph\r\n     * @param camera The camera to use when rendering the scene\r\n     * @param scenegraph The scenegraph to interate over\r\n     */\r\n    debugDraw(camera, scenegraph){\r\n        if(!Graphics.DRAW_DEBUG_INFO) return;\r\n\r\n        if (!camera) throw new Error(\"Can't draw if a camera isn't set\");\r\n\r\n        this.currentShader.passMatrix(\"uPMatrix\", camera.getPerspectiveMatrix());\r\n        this.currentShader.passMatrix(\"uCMatrix\", camera.GetMatrix());\r\n        for(var i = 0; i < scenegraph.debugGraph.length; i++){\r\n            var line = scenegraph.debugGraph[i];\r\n            line.draw(this.currentShader, mat4.create());\r\n        }\r\n\r\n\r\n        for(var i = 0; i < scenegraph.graph.length; i++){\r\n            var entity = scenegraph.graph[i];\r\n            var modelMatrix = entity.getMatrix();\r\n            entity.mesh.DrawNormals(this.currentShader, modelMatrix);\r\n        }\r\n    }\r\n\r\n    instancedDraw(camera){\r\n        this.ctx.viewport(0, 0, this.viewportWidth, this.viewportHeight);\r\n        this.ctx.clear(this.ctx.DEPTH_BUFFER_BIT | this.ctx.COLOR_BUFFER_BIT);\r\n\r\n        /* Mesh position */\r\n        this.currentShader.passMatrix(\"uPMatrix\", camera.getPerspectiveMatrix());\r\n        this.currentShader.passVec3(\"lightDirection\", this._lightDir);\r\n\r\n        if (!camera) throw new Error(\"Can't draw if a camera isn't set\");\r\n        this.currentShader.passMatrix(\"uCMatrix\", camera.getMatrix());\r\n\r\n        this.tileMapRenderer.draw(this.currentShader);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./client/engine/core/graphics.ts","\r\nimport MeshHelper = require(\"../helpers/MeshHelper\");\r\nimport Texture = require(\"../texture\");\r\nimport {Mesh} from \"../mesh\";\r\nimport {Asset} from \"./asset\";\r\nimport Shader = require(\"../shaders\");\r\nimport Font = require(\"../font\");\r\nimport {AssetLoader} from \"./assetLoader\";\r\n/**\r\n * Responsible for turning a collection of resolved remote assets into real assets (Textures/Meshes etc.) and storing them\r\n */\r\nclass AssetCollection {\r\n    ctx:WebGLRenderingContext;\r\n    meshHelper:MeshHelper;\r\n\r\n    meshes:Mesh[];\r\n    textures:Texture[];\r\n    shaderFiles:Asset[];\r\n    shaders:Shader[];\r\n    fontsFiles:Font[];\r\n\r\n    constructor(ctx:WebGLRenderingContext){\r\n        this.ctx = ctx;\r\n        this.meshHelper = new MeshHelper(this.ctx);\r\n\r\n        this.meshes = [];\r\n        this.textures = [];\r\n        this.shaderFiles = [];\r\n        this.shaders = [];\r\n        this.fontsFiles = [];\r\n    }\r\n\r\n    setAssets(assetLoader:AssetLoader) {\r\n        var self = this;\r\n        self.addMesh(\"square\", this.meshHelper.makeSquare());\r\n\r\n        assetLoader.getByType(\"mesh\").forEach(function(meshAsset){\r\n            self.addMesh(meshAsset.name, self.meshHelper.CreateMeshFromAsset(meshAsset));\r\n        });\r\n\r\n\r\n        assetLoader.getByType(\"texture\").forEach(function(textureAsset){\r\n            self.addTexture(textureAsset.name, new Texture(self.ctx, textureAsset.data));\r\n        });\r\n\r\n        assetLoader.getByType(\"shader\").forEach(function(shaderAsset){\r\n            self.addShaderFile(shaderAsset.name, shaderAsset);\r\n        });\r\n\r\n        assetLoader.getByType(\"fnt\").forEach(function(shaderAsset){\r\n            self.addShaderFile(shaderAsset.name, shaderAsset);\r\n        });\r\n    }\r\n\r\n    addMesh(name:string, mesh:Mesh){\r\n        this.meshes[name] = mesh;\r\n    }\r\n\r\n    addTexture(name:string, texture:Texture){\r\n        this.textures[name] = texture;\r\n    }\r\n\r\n    addShaderFile(name:string, shaderFile:Asset){\r\n        this.shaderFiles[name] = shaderFile;\r\n    }\r\n\r\n    addFont(name:string, fontFile:Asset){\r\n        this.fontsFiles[name] = fontFile;\r\n    }\r\n\r\n    createShader(shaderName:string, vShaderName:string, fShaderName:string, attributes:string[], uniforms:string[]) {\r\n        var vShader = this.getShaderFile(vShaderName);\r\n        var fShader = this.getShaderFile(fShaderName);\r\n        var mainShader = new Shader(this.ctx, vShader.data, fShader.data);\r\n        mainShader.LoadAttributes(attributes);\r\n        mainShader.LoadUniforms(uniforms);\r\n        this.shaders[shaderName] = mainShader;\r\n    }\r\n\r\n    getMesh(meshName):Mesh {\r\n        var mesh = this.meshes[meshName];\r\n        if (mesh == null) throw new Error(\"Attempted to access mesh '\" + meshName + \"', but this mesh could not be found\");\r\n        return mesh;\r\n    }\r\n\r\n    getTexture(textureName):Texture {\r\n        var texture = this.textures[textureName];\r\n        if (texture == null) throw new Error(\"Attempted to access texture '\" + textureName + \"', but this texture could not be found\");\r\n        return texture;\r\n    }\r\n\r\n    getShaderFile(shaderFileName):Asset{\r\n        var shaderFile = this.shaderFiles[shaderFileName];\r\n        if (shaderFile == null) throw new Error(\"Attempted to access shaderFile '\" + shaderFileName + \"', but this shaderFile could not be found\");\r\n        return shaderFile;\r\n    }\r\n\r\n    getShader(shaderName):Shader {\r\n        var shader = this.shaders[shaderName];\r\n        if (shader == null) throw new Error(\"Attempted to access shader '\" + shaderName + \"', but this shader could not be found\");\r\n        return shader;\r\n    }\r\n}\r\n\r\nexport = AssetCollection;\n\n\n// WEBPACK FOOTER //\n// ./client/engine/core/assets/assetCollection.ts","import {Mesh} from \"../mesh\";\r\n/**\r\n * Created by Jamie on 20-Jul-15.\r\n */\r\nclass MeshHelper {\r\n    ctx:WebGLRenderingContext;\r\n\r\n    constructor(ctx:WebGLRenderingContext){\r\n        this.ctx = ctx;\r\n    }\r\n\r\n    makeSquare():Mesh{\r\n        return this.makeSquareFromPosition([0, 0, 0], 1);\r\n    }\r\n\r\n    makeSquareFromPosition(position:number[], size:number):Mesh {\r\n        var left = position[0];\r\n        var bottom = position[2];\r\n\r\n        var right = position[0] + size;\r\n        var top = position[2] + size;\r\n\r\n        var y = position[1];\r\n\r\n        var vertices = [\r\n            // Front face\r\n            left, y,  bottom, //bottom left\r\n            right, y,  bottom, //bottom right\r\n            right,  y,  top, //top right\r\n            left,  y,  top]; //top left\r\n\r\n        var indices = [0, 1, 2, 0, 2, 3];\r\n\r\n        var normals = [\r\n            0.0, 1.0, 0.0,\r\n            0.0, 1.0, 0.0,\r\n            0.0, 1.0, 0.0,\r\n            0.0, 1.0, 0.0,\r\n        ];\r\n\r\n        var texCoords = [\r\n            0.0, 1.0,\r\n            1.0, 1.0,\r\n            1.0, 0.0,\r\n            0.0, 0.0,\r\n        ];\r\n\r\n        var mesh = new Mesh(this.ctx);\r\n        mesh.LoadVertices(vertices, indices, null, normals, texCoords);\r\n        return mesh;\r\n    }\r\n\r\n    CreateMeshFromAsset(asset) {\r\n        var mesh = new Mesh(this.ctx);\r\n        mesh.LoadVerticesFromFile(asset.data);\r\n        return mesh;\r\n    }\r\n}\r\n\r\nexport = MeshHelper;\n\n\n// WEBPACK FOOTER //\n// ./client/engine/core/helpers/MeshHelper.ts","import ObjLoader = require(\"./filetypes/objloader\");\r\nimport DebugLine = require(\"./debugLine\");\r\n/**\r\n * Created by Jamie on 02-Jul-15.\r\n */\r\n\r\n\r\n\r\n///<reference path=\"../../lib/gl-matrix.d.ts\" />\r\n\r\nexport class Mesh {\r\n    ctx:WebGLRenderingContext;\r\n    vertexBuffer:WebGLBuffer;\r\n    colorBuffer:WebGLBuffer;\r\n    indexBuffer:WebGLBuffer;\r\n    normalBuffer:WebGLBuffer;\r\n    texturePositionBuffer:WebGLBuffer;\r\n\r\n    normalLines:DebugLine[];\r\n\r\n    numIndices:number;\r\n    vertices:number[];\r\n    normals:number[];\r\n\r\n\r\n    constructor(ctx:WebGLRenderingContext){\r\n        this.ctx = ctx;\r\n        this.vertexBuffer = ctx.createBuffer();\r\n        this.colorBuffer = ctx.createBuffer();\r\n        this.indexBuffer = ctx.createBuffer();\r\n        this.normalBuffer = ctx.createBuffer();\r\n        this.texturePositionBuffer = ctx.createBuffer();\r\n\r\n        this.normalLines = [];\r\n    }\r\n\r\n    LoadVerticesFromFile(file:string){\r\n        var modelData = new ObjLoader().readFile(file);\r\n        this.LoadVertices(modelData.vertices, modelData.indices, modelData.colors, modelData.normals, modelData.texCoords);\r\n    }\r\n\r\n    LoadVertices(vertices:number[], indices:number[], colors:number[], normals:number[], texCoords:number[]){\r\n        this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.vertexBuffer);\r\n        this.ctx.bufferData(this.ctx.ARRAY_BUFFER, new Float32Array(vertices), this.ctx.STATIC_DRAW);\r\n        this.vertices = vertices;\r\n\r\n        this.ctx.bindBuffer(this.ctx.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\r\n        this.ctx.bufferData(this.ctx.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), this.ctx.STATIC_DRAW);\r\n\r\n        if(colors != undefined) {\r\n            this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.colorBuffer);\r\n            this.ctx.bufferData(this.ctx.ARRAY_BUFFER, new Float32Array(colors), this.ctx.STATIC_DRAW);\r\n        }\r\n\r\n        if(normals != undefined) {\r\n            this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.normalBuffer);\r\n            this.ctx.bufferData(this.ctx.ARRAY_BUFFER, new Float32Array(normals), this.ctx.STATIC_DRAW);\r\n            this.normals = normals;\r\n            this.createNormalLines();\r\n        }\r\n\r\n        if(texCoords != undefined) {\r\n            this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.texturePositionBuffer);\r\n            this.ctx.bufferData(this.ctx.ARRAY_BUFFER, new Float32Array(texCoords), this.ctx.STATIC_DRAW);\r\n        }\r\n\r\n        this.numIndices = indices.length;\r\n    }\r\n\r\n    createNormalLines():void{\r\n        for(var i = 0; i < this.vertices.length; i+=3){\r\n            var line = new DebugLine(this.ctx,\r\n                vec3.fromValues(this.vertices[i], this.vertices[i+1], this.vertices[i+2]),\r\n                    vec3.fromValues(this.vertices[i] + this.normals[i], this.vertices[i+1] + this.normals[i+1], this.vertices[i+2] + this.normals[i+2]));\r\n            this.normalLines.push(line);\r\n        }\r\n    }\r\n\r\n    DrawNormals(shader:any, modelMatrix:mat4):void {\r\n        for(var i = 0; i < this.normalLines.length; i++){\r\n            this.normalLines[i].Draw(shader, modelMatrix);\r\n        }\r\n    }\r\n\r\n    bindPositionBuffer(shader:any):void {\r\n        this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.vertexBuffer);\r\n        this.ctx.vertexAttribPointer(shader.attributes[\"aVertexPosition\"], 3, this.ctx.FLOAT, false, 0, 0);\r\n    }\r\n\r\n    bindNormalBuffer(shader:any):void {\r\n        this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.normalBuffer);\r\n        this.ctx.vertexAttribPointer(shader.attributes[\"aVertexNormal\"], 3, this.ctx.FLOAT, false, 0, 0);\r\n    }\r\n\r\n    bindTextureCoordinatesBuffer(shader:any):void {\r\n        this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.texturePositionBuffer);\r\n        this.ctx.vertexAttribPointer(shader.attributes[\"aTexCoords\"], 2, this.ctx.FLOAT, false, 0, 0);\r\n    }\r\n\r\n    bindIndexBuffer(shader:any):void {\r\n        this.ctx.bindBuffer(this.ctx.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\r\n    }\r\n\r\n    bindBuffers(shader:any, modelMatrix:mat4):void {\r\n        this.bindPositionBuffer(shader);\r\n        this.bindNormalBuffer(shader);\r\n        this.bindTextureCoordinatesBuffer(shader);\r\n        this.bindIndexBuffer(shader);\r\n    }\r\n\r\n    Draw(shader:any, modelMatrix:mat4):void{\r\n        //Need to have texture//colours bound at this point\r\n        //if this.material -> this.material.bind\r\n        //add something to notify if shader.attributes[\"name\"] doesn't exist\r\n        //console.log(\"drawing\");\r\n        this.bindBuffers(shader, modelMatrix);\r\n        shader.passMatrix(\"uMVMatrix\", modelMatrix);\r\n\r\n        this.ctx.drawElements(this.ctx.TRIANGLES, this.numIndices, this.ctx.UNSIGNED_SHORT, 0);\r\n    }\r\n\r\n    getBoundingCube(): BoundingCube{\r\n        var boundingCube = new BoundingCube();\r\n        //console.log(this.vertices);\r\n\r\n        for(var i = 0; i < this.vertices.length/3; i++) {\r\n            var currentVertex = {\r\n                x: this.vertices[i * 3],\r\n                y: this.vertices[i * 3 + 1],\r\n                z: this.vertices[i * 3 + 2]\r\n            };\r\n\r\n            if(currentVertex.x < boundingCube.lowest[0]) boundingCube.lowest[0] = currentVertex.x;\r\n            if(currentVertex.x > boundingCube.highest[0]) boundingCube.highest[0] = currentVertex.x;\r\n\r\n            if(currentVertex.y < boundingCube.lowest[1]) boundingCube.lowest[1] = currentVertex.y;\r\n            if(currentVertex.y > boundingCube.highest[1]) boundingCube.highest[1] = currentVertex.y;\r\n\r\n            if(currentVertex.z < boundingCube.lowest[2]) boundingCube.lowest[2] = currentVertex.z;\r\n            if(currentVertex.z > boundingCube.highest[2]) boundingCube.highest[2] = currentVertex.z;\r\n        };\r\n\r\n        return boundingCube;\r\n    }\r\n}\r\n\r\nexport class BoundingCube {\r\n    lowest:Float32Array;\r\n    highest:Float32Array;\r\n\r\n    constructor(){\r\n        this.lowest = vec3.create();\r\n        this.highest = vec3.create();\r\n    }\r\n\r\n    transform(matrix:Float32Array): void {\r\n        vec3.transformMat4(this.lowest, this.lowest, matrix);\r\n        vec3.transformMat4(this.highest, this.highest, matrix);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./client/engine/core/mesh.ts","import {FileLoaderResult, FileLoader} from \"./fileLoader\";\r\n/**\r\n * Created by Jamie on 02-Jul-15.\r\n */\r\n\r\n///<reference path=\"../../../lib/gl-matrix.d.ts\" />\r\n\r\n\r\nclass ObjLoader implements FileLoader {\r\n    vertices: number[];\r\n    indices: number[];\r\n    colors: number[];\r\n    faceNormals: number[];\r\n    vertexNormals: number[];\r\n    vertexNormalCount: number[];\r\n    texCoords: number[];\r\n    textureIndices: number[];\r\n\r\n    constructor(){\r\n        this.vertices = [];\r\n        this.vertexNormals = [];\r\n        this.indices = [];\r\n        this.colors = [];\r\n        this.faceNormals = [];\r\n        this.vertexNormalCount = [];\r\n        this.texCoords = [];\r\n        this.textureIndices = [];\r\n    }\r\n\r\n    readObjectLine(line:string) : boolean {\r\n        if(line[0] === 'o'){\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    readVertexLine(line:string) : boolean {\r\n        var self = this;\r\n        if(line[0] === 'v' && line[1] == ' '){\r\n            line.substr(2).split(\" \").forEach(function(el){\r\n                self.vertices.push(parseFloat(el));\r\n                self.vertexNormals.push(0);\r\n            });\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    readFaceLine(line:string) : boolean {\r\n        var self = this;\r\n        if(line.length < 1) return false;\r\n        if(line[0] === 'f'){\r\n            var re = /\\d+\\/\\d+/;\r\n            if(line.match(re)){\r\n                this.readComplexFaceLine(line);\r\n            } else {\r\n                this.readSimpleFaceLine(line);\r\n            }\r\n\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    readComplexFaceLine(line:string) : void {\r\n        var self = this;\r\n        line.substr(2).split(\" \").forEach(function(el){\r\n            var vals = el.split(\"/\");\r\n            self.indices.push(parseInt(vals[0])-1);\r\n            self.textureIndices.push(parseInt(vals[1])-1);\r\n            self.vertexNormalCount.push(0);\r\n            self.colors.push(1); self.colors.push(1); self.colors.push(1);\r\n        });\r\n    }\r\n\r\n    readSimpleFaceLine(line:string) : void {\r\n        var self = this;\r\n        line.substr(2).split(\" \").forEach(function(el){\r\n            self.indices.push(parseInt(el)-1);\r\n            self.vertexNormalCount.push(0);\r\n            self.colors.push(1); self.colors.push(1); self.colors.push(1);\r\n        });\r\n    }\r\n\r\n    readVertexTextureLine(line:string): boolean {\r\n        var self = this;\r\n        if(line[0] === 'v' && line[1] == 't'){\r\n            var vals = line.substr(3).split(\" \");\r\n            var num1 = parseFloat(vals[0]);\r\n            var num2 = 1-parseFloat(vals[1]);\r\n            self.texCoords.push(num1, num2);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    calculateFaceNormals() : void {\r\n        for(var i = 0; i < this.indices.length; i+=3){\r\n            var index1 = this.indices[i];\r\n            var index2 = this.indices[i+1];\r\n            var index3 = this.indices[i+2];\r\n\r\n            var vpos1 = index1 * 3;\r\n            var vpos2 = index2 * 3;\r\n            var vpos3 = index3 * 3;\r\n\r\n\r\n            var vertex1 = vec3.fromValues(this.vertices[vpos1], this.vertices[vpos1+1], this.vertices[vpos1+2]);\r\n            var vertex2 = vec3.fromValues(this.vertices[vpos2], this.vertices[vpos2+1], this.vertices[vpos2+2]);\r\n            var vertex3 = vec3.fromValues(this.vertices[vpos3], this.vertices[vpos3+1], this.vertices[vpos3+2]);\r\n\r\n\r\n            var U = vec3.create(); var P = vec3.create(); var N = vec3.create();\r\n            vec3.subtract(U, vertex2, vertex1);\r\n            vec3.subtract(P, vertex3, vertex1);\r\n            vec3.cross(N, U, P);\r\n            vec3.normalize(N, N);\r\n\r\n\r\n            //add to vertex 1\r\n            this.vertexNormals[vpos1] += N[0];\r\n            this.vertexNormals[vpos1 + 1] += N[1];\r\n            this.vertexNormals[vpos1 + 2] += N[2];\r\n            this.vertexNormalCount[index1] += 1;\r\n\r\n            //add to vertex 2\r\n            this.vertexNormals[vpos2] += N[0];\r\n            this.vertexNormals[vpos2 + 1] += N[1];\r\n            this.vertexNormals[vpos2 + 2] += N[2];\r\n            this.vertexNormalCount[index2] += 1;\r\n\r\n            //add to vertex 3\r\n            this.vertexNormals[vpos3] += N[0];\r\n            this.vertexNormals[vpos3 + 1] += N[1];\r\n            this.vertexNormals[vpos3 + 2] += N[2];\r\n            this.vertexNormalCount[index3] += 1;\r\n        }\r\n\r\n        for(var i = 0; i < this.vertices.length; i+=3){\r\n            var vpos = i;\r\n\r\n            //this.vertexNormals[vpos] /= this.vertexNormalCount[index];\r\n            //this.vertexNormals[vpos+1] /= this.vertexNormalCount[index];\r\n            //this.vertexNormals[vpos+2] /= this.vertexNormalCount[index];\r\n\r\n\r\n            var sq1 = this.vertexNormals[vpos] * this.vertexNormals[vpos];\r\n            var sq2 = this.vertexNormals[vpos+1] * this.vertexNormals[vpos+1];\r\n            var sq3 = this.vertexNormals[vpos+2] * this.vertexNormals[vpos+2];\r\n\r\n\r\n            var magnitude = Math.sqrt(sq1 + sq2 + sq3);\r\n            this.vertexNormals[vpos] /= magnitude;\r\n            this.vertexNormals[vpos+1] /= magnitude;\r\n            this.vertexNormals[vpos+2] /= magnitude;\r\n\r\n        }\r\n    }\r\n\r\n    duplicateTexturePositions() : void {\r\n        var newVertices = [];\r\n        var newNormals = [];\r\n        var newTexCoords = [];\r\n        var newIndices = [];\r\n        var newColors = [];\r\n\r\n        var indexTextureIndices = [];\r\n        for(var i = 0; i < this.indices.length; i++){\r\n            var index = this.indices[i];\r\n            var textureIndex = this.textureIndices[i];\r\n            indexTextureIndices[index] = (indexTextureIndices[index] == undefined)? [] : indexTextureIndices[index];\r\n            indexTextureIndices[index].push(textureIndex);\r\n        }\r\n\r\n        for(var i = 0; i < this.indices.length; i++){\r\n            var index = this.indices[i];\r\n            var textureIndices = indexTextureIndices[index];\r\n\r\n            var firstTextureIndex = textureIndices[0];\r\n\r\n            newVertices.push(this.vertices[index * 3], this.vertices[index * 3 + 1], this.vertices[index * 3 + 2]);\r\n            newNormals.push(this.vertexNormals[index * 3], this.vertexNormals[index * 3 + 1], this.vertexNormals[index * 3 + 2]);\r\n            newTexCoords.push(this.texCoords[firstTextureIndex * 2], this.texCoords[firstTextureIndex * 2 + 1]);\r\n            newColors.push(1.0, 1.0, 1.0);\r\n            newIndices.push(i);\r\n            indexTextureIndices[index].splice(0, 1);\r\n        }\r\n\r\n        this.vertices = newVertices;\r\n        this.indices = newIndices;\r\n        this.vertexNormals = newNormals;\r\n        this.colors = newColors;\r\n        this.texCoords = newTexCoords;\r\n    }\r\n\r\n    readFile(fileString:string) : FileLoaderResult {\r\n        var lines = fileString.split(\"\\n\");\r\n        for(var i = 0; i < lines.length; i++){\r\n            var line = lines[i];\r\n            (this.readVertexLine(line) || this.readFaceLine(line) || this.readVertexTextureLine(line) || this.readObjectLine(line))\r\n        }\r\n\r\n        this.calculateFaceNormals();\r\n        this.duplicateTexturePositions();\r\n\r\n        var result = {\r\n            vertices: this.vertices,\r\n            indices: this.indices,\r\n            colors: this.colors,\r\n            normals: this.vertexNormals,\r\n            texCoords: this.texCoords\r\n        }\r\n        return result;\r\n    }\r\n}\r\n\r\nexport = ObjLoader;\n\n\n// WEBPACK FOOTER //\n// ./client/engine/core/filetypes/objloader.ts","class DebugLine {\r\n\r\n    ctx:WebGLRenderingContext;\r\n    vertexBuffer:WebGLRenderbuffer;\r\n    colorBuffer:WebGLRenderbuffer;\r\n    indexBuffer:WebGLRenderbuffer;\r\n\r\n    constructor(ctx:WebGLRenderingContext, pos1:Float32Array, pos2:Float32Array){\r\n        this.ctx = ctx;\r\n        var vertices = [pos1[0], pos1[1], pos1[2], pos2[0], pos2[1], pos2[2]];\r\n        var indices = [0, 1];\r\n        //green to blue\r\n        var colors = [0, 1, 0, 0, 0, 1];\r\n\r\n        this.vertexBuffer = ctx.createBuffer();\r\n        this.colorBuffer = ctx.createBuffer();\r\n        this.indexBuffer = ctx.createBuffer();\r\n\r\n        this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.vertexBuffer);\r\n        this.ctx.bufferData(this.ctx.ARRAY_BUFFER, new Float32Array(vertices), this.ctx.STATIC_DRAW);\r\n\r\n        this.ctx.bindBuffer(this.ctx.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\r\n        this.ctx.bufferData(this.ctx.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), this.ctx.STATIC_DRAW);\r\n\r\n        this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.colorBuffer);\r\n        this.ctx.bufferData(this.ctx.ARRAY_BUFFER, new Float32Array(colors), this.ctx.STATIC_DRAW);\r\n    }\r\n\r\n    Draw(shader:any, modelMatrix:mat4):void{\r\n        //Need to have texture//colours bound at this point\r\n        //if this.material -> this.material.bind\r\n        //add something to notify if shader.attributes[\"name\"] doesn't exist\r\n        //console.log(\"drawing\");\r\n        shader.passMatrix(\"uMVMatrix\", modelMatrix);\r\n\r\n        this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.vertexBuffer);\r\n        this.ctx.vertexAttribPointer(shader.attributes[\"aVertexPosition\"], 3, this.ctx.FLOAT, false, 0, 0);\r\n\r\n        this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.colorBuffer);\r\n        this.ctx.vertexAttribPointer(shader.attributes[\"aVertexColour\"], 3, this.ctx.FLOAT, false, 0, 0);\r\n\r\n        this.ctx.bindBuffer(this.ctx.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\r\n        this.ctx.drawElements(this.ctx.LINES, 2, this.ctx.UNSIGNED_SHORT, 0);\r\n    }\r\n}\r\n\r\nexport = DebugLine;\n\n\n// WEBPACK FOOTER //\n// ./client/engine/core/debugLine.ts","/**\r\n * Created by Jamie on 28-Jun-15.\r\n */\r\nclass Texture {\r\n    ctx:WebGLRenderingContext;\r\n    image:HTMLImageElement;\r\n    id:WebGLTexture;\r\n\r\n    constructor(ctx:WebGLRenderingContext, img:HTMLImageElement){\r\n        if(ctx == null) throw new Error(\"Ctx cannot be null for texture to load\");\r\n        this.ctx = ctx;\r\n        this.image = img;\r\n\r\n        this.ctx.enable(this.ctx.BLEND);\r\n        this.ctx.blendFunc(this.ctx.SRC_ALPHA, this.ctx.ONE_MINUS_SRC_ALPHA);\r\n\r\n        this.id = this.ctx.createTexture();\r\n        this.ctx.bindTexture(this.ctx.TEXTURE_2D, this.id);\r\n        this.ctx.texImage2D(this.ctx.TEXTURE_2D, 0, this.ctx.RGBA, this.ctx.RGBA, this.ctx.UNSIGNED_BYTE, this.image);\r\n        this.ctx.texParameteri(this.ctx.TEXTURE_2D, this.ctx.TEXTURE_MAG_FILTER, this.ctx.LINEAR);\r\n        this.ctx.texParameteri(this.ctx.TEXTURE_2D, this.ctx.TEXTURE_MIN_FILTER, this.ctx.LINEAR_MIPMAP_LINEAR);\r\n        this.ctx.generateMipmap(this.ctx.TEXTURE_2D);\r\n        this.ctx.bindTexture(this.ctx.TEXTURE_2D, null);\r\n    }\r\n\r\n    Bind(){\r\n        this.ctx.enable(this.ctx.BLEND);\r\n        this.ctx.blendFunc(this.ctx.SRC_ALPHA, this.ctx.ONE_MINUS_SRC_ALPHA);\r\n        this.ctx.activeTexture(this.ctx.TEXTURE0);\r\n        this.ctx.bindTexture(this.ctx.TEXTURE_2D, this.id);\r\n    }\r\n}\r\n\r\nexport = Texture;\n\n\n// WEBPACK FOOTER //\n// ./client/engine/core/texture.ts","\r\nclass Shader {\r\n    ctx:WebGLRenderingContext;\r\n    vSource:string;\r\n    fSource:string;\r\n\r\n    uniforms:string[];\r\n    attributes:string[];\r\n\r\n    shaderProgram:WebGLProgram;\r\n\r\n    constructor(ctx:WebGLRenderingContext, vSource:string, fSource:string){\r\n        this.vSource = vSource;\r\n        this.fSource = fSource;\r\n        this.ctx = ctx;\r\n\r\n        this.uniforms = [];\r\n        this.attributes = [];\r\n\r\n        var vShader = ctx.createShader(ctx.VERTEX_SHADER);\r\n        var fShader = ctx.createShader(ctx.FRAGMENT_SHADER);\r\n\r\n        ctx.shaderSource(vShader, vSource);\r\n        ctx.shaderSource(fShader, fSource);\r\n\r\n        ctx.compileShader(vShader);\r\n        ctx.compileShader(fShader);\r\n\r\n        this.shaderProgram = ctx.createProgram();\r\n\r\n        ctx.attachShader(this.shaderProgram, vShader);\r\n        ctx.attachShader(this.shaderProgram, fShader);\r\n        ctx.linkProgram(this.shaderProgram);\r\n    }\r\n\r\n    LoadUniforms(uniformNames:string[]){\r\n        this.Activate();\r\n\r\n        for(var i = 0; i < uniformNames.length; i++) {\r\n            var unifName = uniformNames[i];\r\n            var unifLoc = this.ctx.getUniformLocation(this.shaderProgram, unifName);\r\n\r\n            if(unifLoc == null){\r\n                throw new Error(\"Error loading uniform \" + unifName);\r\n            }\r\n            this.uniforms[unifName] = unifLoc;\r\n        }\r\n    }\r\n\r\n    LoadAttributes(attributeNames:string[]){\r\n        this.Activate();\r\n\r\n        for(var i = 0; i < attributeNames.length; i++) {\r\n            var attribName = attributeNames[i];\r\n            var attribLoc = this.ctx.getAttribLocation(this.shaderProgram, attribName);\r\n            if(attribLoc == -1){\r\n                throw new Error(\"Error loading attribute \" + attribName);\r\n            }\r\n            this.ctx.enableVertexAttribArray(attribLoc);\r\n            this.attributes[attribName] = attribLoc;\r\n        }\r\n    }\r\n\r\n    Activate() : void {\r\n        this.ctx.useProgram(this.shaderProgram);\r\n    }\r\n\r\n    Deactivate() : void {\r\n        this.ctx.useProgram(null);\r\n\r\n        this.attributes.forEach(function(element){\r\n            this.ctx.disableVertexAttribArray(element);\r\n        });\r\n\r\n    }\r\n\r\n    passMatrix(uniformName, matrix) : void{\r\n        this.ctx.uniformMatrix4fv(this.uniforms[uniformName], false, matrix);\r\n    }\r\n\r\n    passVec3(uniformName, vector) : void {\r\n        this.ctx.uniform3f(this.uniforms[uniformName], vector[0], vector[1], vector[2]);\r\n    }\r\n}\r\n\r\nexport = Shader;\n\n\n// WEBPACK FOOTER //\n// ./client/engine/core/shaders.ts","import {TileMap, TileLevel, TileMapTile} from \"../game/tileMap\";\r\nimport Shader = require(\"./shaders\");\r\n/**\r\n * Created by Jamie on 26-Jul-15.\r\n */\r\n\r\n\r\n\r\nclass TileMapRenderer {\r\n    private ctx:WebGLRenderingContext;\r\n    private vertexBuffer:WebGLBuffer;\r\n    private indexBuffer:WebGLBuffer;\r\n    private normalBuffer:WebGLBuffer;\r\n    private texturePositionBuffer:WebGLBuffer;\r\n\r\n    private tileMap:TileMap;\r\n\r\n    private tileIndex:number;\r\n\r\n    private vertices:number[];\r\n    private indices:number[];\r\n    private texCoords:number[];\r\n    private normals:number[];\r\n\r\n    constructor(ctx:WebGLRenderingContext){\r\n        this.ctx = ctx;\r\n        this.tileIndex = 0;\r\n\r\n        this.vertexBuffer = ctx.createBuffer();\r\n        this.normalBuffer = ctx.createBuffer();\r\n        this.indexBuffer = ctx.createBuffer();\r\n        this.texturePositionBuffer = ctx.createBuffer();\r\n    }\r\n\r\n    setTileMap(tileMap:TileMap): void {\r\n        this.tileMap = tileMap;\r\n        this.calculateDataForTileMap(tileMap);\r\n        this.updateData();\r\n    }\r\n\r\n    updateData(){\r\n        this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.vertexBuffer);\r\n        this.ctx.bufferData(this.ctx.ARRAY_BUFFER, new Float32Array(this.vertices), this.ctx.DYNAMIC_DRAW);\r\n\r\n        this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.normalBuffer);\r\n        this.ctx.bufferData(this.ctx.ARRAY_BUFFER, new Float32Array(this.normals), this.ctx.DYNAMIC_DRAW);\r\n\r\n        this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.texturePositionBuffer);\r\n        this.ctx.bufferData(this.ctx.ARRAY_BUFFER, new Float32Array(this.texCoords), this.ctx.DYNAMIC_DRAW);\r\n\r\n        this.ctx.bindBuffer(this.ctx.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\r\n        this.ctx.bufferData(this.ctx.ELEMENT_ARRAY_BUFFER, new Uint16Array(this.indices), this.ctx.DYNAMIC_DRAW);\r\n    }\r\n\r\n    bindPositionBuffer(shader:any):void {\r\n        this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.vertexBuffer);\r\n        this.ctx.vertexAttribPointer(shader.attributes[\"aVertexPosition\"], 3, this.ctx.FLOAT, false, 0, 0);\r\n    }\r\n\r\n    bindNormalBuffer(shader:any):void {\r\n        this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.normalBuffer);\r\n        this.ctx.vertexAttribPointer(shader.attributes[\"aVertexNormal\"], 3, this.ctx.FLOAT, false, 0, 0);\r\n    }\r\n\r\n    bindTextureCoordinatesBuffer(shader:any):void {\r\n        this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER, this.texturePositionBuffer);\r\n        this.ctx.vertexAttribPointer(shader.attributes[\"aTexCoords\"], 2, this.ctx.FLOAT, false, 0, 0);\r\n    }\r\n\r\n    bindIndexBuffer(shader:any):void {\r\n        this.ctx.bindBuffer(this.ctx.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\r\n    }\r\n\r\n    bindBuffers(shader:any):void {\r\n        this.bindPositionBuffer(shader);\r\n        this.bindNormalBuffer(shader);\r\n        this.bindTextureCoordinatesBuffer(shader);\r\n        this.bindIndexBuffer(shader);\r\n    }\r\n\r\n    draw(shader:Shader){\r\n        this.tileMap.getImageMap().getTexture().Bind();\r\n        this.bindBuffers(shader);\r\n        this.ctx.drawElements(this.ctx.TRIANGLES, this.indices.length, this.ctx.UNSIGNED_SHORT, 0);\r\n    }\r\n\r\n    calculateDataForTileMap(tileMap:TileMap) {\r\n        this.vertices = [];\r\n        this.indices = [];\r\n        this.texCoords = [];\r\n        this.normals = [];\r\n\r\n        this.tileIndex = 0;\r\n\r\n        var tileLevels = tileMap.getTileLevels();\r\n        var result = [];\r\n        for(var i = 0; i < tileLevels.length; i++){\r\n            var tileLevel = tileLevels[i];\r\n            this.calculateDataForTileLevel(tileLevel);\r\n        }\r\n    }\r\n\r\n    calculateDataForTileLevel(tileLevel:TileLevel){\r\n        var tiles = tileLevel.getTiles();\r\n        var result = [];\r\n        for(var i = 0; i < tiles.length; i++){\r\n            var tile = tiles[i];\r\n            this.calculateDataForTile(tile);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    calculateDataForTile(tile:TileMapTile){\r\n        var left = tile.x;\r\n        var bottom = tile.z;\r\n\r\n        var right = tile.x + this.tileMap.getTileWidth();\r\n        var top = tile.z + this.tileMap.getTileHeight();\r\n\r\n\r\n        var y = tile.y;\r\n\r\n        var vertices = [\r\n            // Front face\r\n            left, y,  bottom, //bottom left\r\n            right, y,  bottom, //bottom right\r\n            right,  y,  top, //top right\r\n            left,  y,  top]; //top left\r\n\r\n        var indices = [0 + this.tileIndex, 1 + this.tileIndex, 2 + this.tileIndex, 0 + this.tileIndex, 2 + this.tileIndex, 3 + this.tileIndex];\r\n\r\n        var normals = [\r\n            0.0, 1.0, 0.0,\r\n            0.0, 1.0, 0.0,\r\n            0.0, 1.0, 0.0,\r\n            0.0, 1.0, 0.0,\r\n        ];\r\n\r\n        var texCoords = this.tileMap.getImageMap().getCoordsAtIndex(tile.getImageMapIndex());\r\n        this.tileIndex +=4;\r\n\r\n        Array.prototype.push.apply(this.vertices, vertices);\r\n        Array.prototype.push.apply(this.indices, indices);\r\n        Array.prototype.push.apply(this.normals, normals);\r\n        Array.prototype.push.apply(this.texCoords, texCoords)\r\n    }\r\n}\r\n\r\nexport = TileMapRenderer;\n\n\n// WEBPACK FOOTER //\n// ./client/engine/core/tileMapRenderer.ts","/**\r\n * Responsible for wrapping up all calls to the WebGL context to ensure\r\n * the entire framework can be mocked\r\n */\r\nexport interface Context {\r\n    clearColor(r:number, g:number, b:number, a:number);\r\n    setDepthTestEnabled(value:boolean);\r\n    setVertexAttribArrayEnabled(arrayIndex:number, value:boolean);\r\n    getError():number;\r\n}\r\n\r\nexport class DefaultContext implements Context {\r\n\r\n    ctx:WebGLRenderingContext;\r\n\r\n    constructor(canvas:HTMLCanvasElement){\r\n        this.ctx = canvas.getContext(\"webgl\");\r\n    }\r\n\r\n    clearColor(r:number, g:number, b:number, a:number) {\r\n      this.ctx.clearColor(r, g, b, a);\r\n    }\r\n\r\n    setDepthTestEnabled(value:boolean){\r\n        if(value)\r\n            this.ctx.enable(this.ctx.DEPTH_TEST);\r\n        else\r\n            this.ctx.disable(this.ctx.DEPTH_TEST);\r\n    }\r\n\r\n    setVertexAttribArrayEnabled(arrayIndex:number, value:boolean){\r\n        if(value)\r\n            this.ctx.enableVertexAttribArray(arrayIndex);\r\n        else\r\n            this.ctx.disableVertexAttribArray(arrayIndex);\r\n    }\r\n\r\n    getError():number{\r\n        return this.ctx.getError();\r\n    }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./client/engine/core/context.ts","import {Asset} from \"./asset\";\r\nimport {RemoteAsset} from \"./remoteAsset\";\r\n\r\ndeclare var Promise: any;\r\n\r\n/**\r\n * Responsible for resolving a collection of urls into asset objects\r\n */\r\nexport class AssetLoader {\r\n    urls:RemoteAsset[];\r\n    assets:Asset[];\r\n\r\n    constructor(urls:RemoteAsset[]) {\r\n        this.urls = urls;\r\n        this.assets = [];\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param url The url to fire the ajax request to\r\n     * @returns {Promise} Called when the asset file has been downloaded\r\n     * @constructor\r\n     */\r\n    resolveFile(url:string){\r\n        var promise = new Promise(function(resolve, reject){\r\n            var request = new XMLHttpRequest();\r\n            request.open(\"GET\", url, true);\r\n            request.onreadystatechange = function(){\r\n                if(request.readyState == 0 || request.readyState==4){\r\n                    if(request.status == 200){\r\n                        resolve(request.responseText);\r\n                    } else {\r\n                        reject(request.status + \" \" + request.responseText);\r\n                    }\r\n                }\r\n            }\r\n            request.send();\r\n        });\r\n        return promise;\r\n    }\r\n\r\n    resolveAsset(url:string, name:string, type:string){\r\n        var self = this;\r\n        var promise = new Promise(function(resolve, reject){\r\n            self.resolveFile(url).then(function(data){\r\n                self.assets[name] = new Asset(data, name, type);\r\n                console.log(\"Resolved asset \" + name);\r\n                resolve();\r\n            });\r\n        })\r\n        return promise;\r\n    }\r\n\r\n    resolveImage(url, name, type){\r\n        var self = this;\r\n        var promise = new Promise(function(resolve, reject){\r\n            var image = new Image();\r\n            image.onload = function(){\r\n                console.log(\"image loaded\");\r\n                self.assets[name] = new Asset(image, name, type);\r\n                resolve();\r\n            };\r\n            image.src = url;\r\n        });\r\n        return promise;\r\n    }\r\n\r\n    loadAll(){\r\n        var promises = [];\r\n        for(var i = 0; i < this.urls.length; i++){\r\n            if(this.urls[i].type != \"texture\")\r\n                promises.push(this.resolveAsset(this.urls[i].url, this.urls[i].name, this.urls[i].type));\r\n            else\r\n                promises.push(this.resolveImage(this.urls[i].url, this.urls[i].name, this.urls[i].type));\r\n        }\r\n\r\n        var loadingPromise = Promise.all(promises).then(function(){\r\n            console.log(\"All _textureAssets loaded\");\r\n        }).catch(function(){\r\n            console.log(\"Failed to load _textureAssets\");\r\n        });\r\n        return loadingPromise;\r\n    }\r\n\r\n    getAsset(assetName):Asset{\r\n        return this.assets[assetName];\r\n    }\r\n\r\n    getByType(type):Asset[]{\r\n        var results = [];\r\n        var keys = Object.keys(this.assets);\r\n        for(var i = 0; i < keys.length; i++){\r\n            if(this.assets[keys[i]].type == type) results.push(this.assets[keys[i]]);\r\n        }\r\n\r\n        return results;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./client/engine/core/assets/assetLoader.ts","/**\r\n * Created by Jamie on 20-Jul-15.\r\n */\r\nexport class Asset {\r\n    data:any;\r\n    name:string;\r\n    type:string;\r\n\r\n    constructor(data:any, name:string, type:string) {\r\n        this.data = data;\r\n        this.name = name;\r\n        this.type = type;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./client/engine/core/assets/asset.ts","///<reference path=\"../../lib/gl-matrix.d.ts\" />\r\n\r\nexport class Camera {\r\n    perspectiveMatrix:Float32Array;\r\n    matrix:Float32Array;\r\n    position:Float32Array;\r\n    //TODO: Camera needs a focal point and a camera point, needs to be possible to set both\r\n\r\n    constructor(width, height, fov, znear, zfar) {\r\n        this.matrix = mat4.create();\r\n        this.position = mat4.create();\r\n        this.perspectiveMatrix = mat4.create();\r\n\r\n        var vec = vec3.fromValues(0, -2, -10);\r\n        mat4.translate(this.position, this.position, vec);\r\n\r\n        mat4.perspective(this.perspectiveMatrix, fov, width / height, znear, zfar);\r\n    }\r\n\r\n    getMatrix(){\r\n        var result = mat4.create();\r\n        mat4.multiply(result,  this.position, this.matrix);\r\n        return result;\r\n    }\r\n\r\n    getPerspectiveMatrix():Float32Array {\r\n        return this.perspectiveMatrix;\r\n    }\r\n\r\n    setMatrix(matrix:Float32Array){\r\n        this.matrix = matrix;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./client/engine/camera/camera.ts","\r\nimport {MousePosition} from \"./mousePosition\";\r\nimport {Arcball} from \"../camera/behaviours/arcballBehaviour\";\r\nimport {CameraClickBehaviour} from \"../camera/behaviours/clickBehaviour\";\r\nimport {Camera} from \"../camera/camera\";\r\nexport interface MouseMoveListener {\r\n    onMouseMove(fromX, fromY, toX, toY);\r\n}\r\n\r\nexport interface MouseRayListener {\r\n\r\n}\r\n\r\nexport interface MouseClickListener {\r\n    onMouseClick(x, y);\r\n}\r\n\r\nexport interface KeyDownListener {\r\n    onKeyDown(keyCode);\r\n}\r\n\r\nexport interface KeyUpListener {\r\n    onKeyUp(keyCode);\r\n}\r\n\r\nexport class InputListener {\r\n    previousMouse:MousePosition;\r\n    currentMouse:MousePosition;\r\n    currentClientMouse:MousePosition;\r\n\r\n    isLeftMouseDown:boolean;\r\n    isMiddleMouseDown:boolean;\r\n\r\n    cameraBehaviour:Arcball;\r\n    cameraClickBehaviour:CameraClickBehaviour;\r\n    camera:Camera;\r\n    element:HTMLElement;\r\n\r\n    private mouseMoveListener:MouseMoveListener;\r\n    private mouseClickListener:MouseClickListener;\r\n    private keyDownListener:KeyDownListener;\r\n    private keyUpListener:KeyUpListener;\r\n    private mouseRayListener:MouseRayListener;\r\n\r\n    constructor(element) {\r\n        var self = this;\r\n\r\n        this.previousMouse = null;\r\n        this.currentMouse = null;\r\n\r\n        this.isLeftMouseDown = false;\r\n        this.isMiddleMouseDown = false;\r\n\r\n        this.cameraBehaviour = new Arcball();\r\n        this.element = element;\r\n\r\n        element.onmousemove =  function(evt){\r\n            self.OnMouseMove(evt);\r\n        }\r\n\r\n        element.onmousedown = function(evt){\r\n            switch(evt.which){\r\n                case 1:\r\n                    self.isLeftMouseDown = true;\r\n                    break;\r\n                case 2:\r\n                    self.isMiddleMouseDown = true;\r\n                    break;\r\n            }\r\n        }\r\n\r\n        document.onmouseup = function(evt){\r\n            switch(evt.which){\r\n                case 1:\r\n                    self.isLeftMouseDown = false;\r\n                    self.onClick();\r\n                    break;\r\n                case 2:\r\n                    self.isMiddleMouseDown = false;\r\n                    break;\r\n            }\r\n        }\r\n\r\n        document.onkeydown = function(evt){\r\n            if(evt.keyCode == 87){\r\n                self.isMiddleMouseDown = true;\r\n            }\r\n        }\r\n\r\n        document.onkeyup = function(evt){\r\n            if(evt.keyCode == 87){\r\n                self.isMiddleMouseDown = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    setMouseMoveListener(listener:MouseMoveListener){\r\n        this.mouseMoveListener = listener;\r\n    }\r\n\r\n    setMouseClickListener(listener:MouseClickListener){\r\n        this.mouseClickListener = listener;\r\n    }\r\n\r\n    setMouseRayListener(listener:MouseRayListener){\r\n        this.mouseRayListener = listener;\r\n    }\r\n\r\n    setKeyDownListener(listener:KeyDownListener){\r\n        this.keyDownListener = listener;\r\n    }\r\n\r\n    setKeyUpListener(listener:KeyUpListener){\r\n        this.keyUpListener = listener;\r\n    }\r\n\r\n    ControlCamera(camera){\r\n        this.camera = camera;\r\n    }\r\n\r\n    setOnCameraClickBehaviour(cameraClickBehaviour){\r\n        this.cameraClickBehaviour = cameraClickBehaviour;\r\n    }\r\n\r\n    OnMouseMove(evt){\r\n        this.currentMouse = new MousePosition(evt.x, evt.y);\r\n        this.currentClientMouse = new MousePosition(evt.pageX - this.element.offsetLeft, evt.pageY - this.element.offsetTop);\r\n        if(!this.previousMouse) this.previousMouse = this.currentMouse;\r\n\r\n        if(this.mouseMoveListener)\r\n            this.mouseMoveListener.onMouseMove(this.previousMouse.x, this.previousMouse.y, this.currentClientMouse.x, this.currentClientMouse.y);\r\n    }\r\n\r\n    onClick():void {\r\n        this.cameraClickBehaviour.onClick(this.currentClientMouse);\r\n        if(this.mouseClickListener)\r\n            this.mouseClickListener.onMouseClick(this.currentClientMouse.x, this.currentClientMouse.y);\r\n\r\n    }\r\n\r\n    Update(){\r\n        if(!this.previousMouse || !this.currentMouse){\r\n            return;\r\n        }\r\n\r\n        if(this.isMiddleMouseDown) {\r\n            this.camera.setMatrix(this.cameraBehaviour.CalculateMoveMatrix(this.previousMouse, this.currentMouse));\r\n        }\r\n        this.previousMouse = this.currentMouse;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./client/engine/input/input.ts","export class MousePosition {\r\n    x:number;\r\n    y:number;\r\n\r\n    constructor(x:number, y:number){\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./client/engine/input/mousePosition.ts","///<reference path=\"../../../lib/gl-matrix.d.ts\" />\r\n\r\nexport class Arcball {\r\n\r\n    xRot:number;\r\n    yRot:number;\r\n\r\n    constructor(){\r\n        this.xRot = 0;\r\n        this.yRot = 0;\r\n    }\r\n\r\n    _GetArcballVector(x, y){\r\n        var vec = vec3.fromValues(\r\n            1 * x / 800 * 2 - 1,\r\n            1 * y / 600 * 2 - 1,\r\n            0\r\n        );\r\n        vec[1] *=-1;\r\n\r\n        var OP_squared = vec[0] * vec[0] + vec[1] * vec[1];\r\n        if (OP_squared <= 1*1) {\r\n            vec[2] = Math.sqrt(1 * 1 - OP_squared);  // Pythagore\r\n        }\r\n        else {\r\n            // vec3.normalize(vec, vec);  // nearest point\r\n        }\r\n\r\n        return vec;\r\n    }\r\n\r\n    CalculateMoveMatrix(pointA, pointB){\r\n        var result = mat4.create();\r\n\r\n        var prevCameraVector = this._GetArcballVector(pointA.x, pointA.y);\r\n        var nextCameraVector = this._GetArcballVector(pointB.x, pointB.y);\r\n\r\n\r\n\r\n        var prevCameraVectorX = vec3.fromValues(0, prevCameraVector[1], prevCameraVector[2]);\r\n        vec3.normalize(prevCameraVectorX, prevCameraVectorX);\r\n\r\n        var nextCameraVectorX = vec3.fromValues(0, nextCameraVector[1], nextCameraVector[2])\r\n        vec3.normalize(nextCameraVectorX, nextCameraVectorX);\r\n\r\n        var xAngle = Math.acos(Math.min(1.0, vec3.dot(prevCameraVectorX, nextCameraVectorX)));\r\n\r\n        if(nextCameraVector[1] - prevCameraVector[1] < 0){\r\n            this.xRot += xAngle;\r\n        } else if(nextCameraVector[1] - prevCameraVector[1] > 0) {\r\n            this.xRot -= xAngle;\r\n        }\r\n\r\n        if(this.xRot > Math.PI * 2){\r\n            this.xRot = 0;\r\n        }\r\n        if (this.xRot < 0){\r\n            this.xRot = Math.PI * 2;\r\n        }\r\n\r\n\r\n        mat4.rotate(result, result, this.xRot, vec3.fromValues(1, 0, 0));\r\n\r\n        var prevCameraVectorY = vec3.fromValues(prevCameraVector[0], 0, prevCameraVector[2]);\r\n        vec3.normalize(prevCameraVectorY, prevCameraVectorY);\r\n\r\n        var nextCameraVectorY = vec3.fromValues(nextCameraVector[0], 0, nextCameraVector[2]);\r\n        vec3.normalize(nextCameraVectorY, nextCameraVectorY);\r\n\r\n        var yAngle = Math.acos(Math.min(1.0, vec3.dot(prevCameraVectorY, nextCameraVectorY)));\r\n\r\n        if(nextCameraVector[0] - prevCameraVector[0] < 0){\r\n            this.yRot -= yAngle;\r\n        } else if(nextCameraVector[0] - prevCameraVector[0] > 0) {\r\n            this.yRot += yAngle;\r\n        }\r\n\r\n        if(this.yRot > Math.PI * 2){\r\n            this.yRot = 0;\r\n        }\r\n        if (this.yRot < 0){\r\n            this.yRot = Math.PI * 2;\r\n        }\r\n\r\n        mat4.rotate(result, result, this.yRot, vec3.fromValues(0, 1, 0));\r\n        return result;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./client/engine/camera/behaviours/arcballBehaviour.ts","import {MouseMoveListener} from \"../input/input\";\r\nimport Tile = require(\"./entities/tile\");\r\nimport {Scenegraph} from \"./scenegraph\";\r\nimport DebugLine = require(\"../core/debugLine\");\r\nimport {TileMap, TileLevel, TileMapTile} from \"./tileMap\";\r\nimport Peon = require(\"./entities/peon\");\r\nimport Ray = require(\"./ray\");\r\nimport {ImageMap} from \"../core/imageMap\";\r\n/**\r\n * Created by Jamie on 14-Jun-15.\r\n */\r\n\r\n\r\nexport class Scene implements MouseMoveListener {\r\n   engine:any;\r\n   sceneGraph:Scenegraph;\r\n\r\n   selectTile:Tile;\r\n\r\n   constructor(engine:any){\r\n       this.engine = engine;\r\n       this.engine.graphics._lightDir = [0, 1, 0];\r\n       this.sceneGraph = this.engine.sceneGraph;\r\n       this.sceneGraph.setScene(this);\r\n       this.engine.input.setMouseClickListener(this);\r\n   }\r\n\r\n   drawDebugLine(p1:Float32Array, p2:Float32Array){\r\n      this.sceneGraph.debugGraph.push(new DebugLine(this.engine.graphics.ctx, p1, p2));\r\n   }\r\n\r\n   onStart(){\r\n       this.selectTile = new Tile(this.engine);\r\n       var tileMap = new TileMap(1, 1);\r\n       var imageMap = new ImageMap(this.engine.graphics.assetCollection.getTexture(\"tileMap\"), 1024, 1024, 256, 256);\r\n       tileMap.setImageMap(imageMap);\r\n\r\n       var bottomTileLevel = new TileLevel(tileMap);\r\n       for(var x = 0; x < 100; x++){\r\n           for(var y = 0; y < 100; y++) {\r\n               var tile = new TileMapTile(x - 50, 0, y - 50);\r\n\r\n               var rnd = Math.random();\r\n               if(rnd > 0.2){\r\n                   tile.setImageMapIndex(4);\r\n               } else {\r\n                   var randomTextureIndex = Math.round(Math.random() * 16);\r\n                   tile.setImageMapIndex(randomTextureIndex);\r\n               }\r\n\r\n               bottomTileLevel.setTile(x * 100 + y, tile);\r\n           }\r\n       }\r\n       tileMap.getTileLevels().push(bottomTileLevel);\r\n\r\n       this.engine.graphics.tileMapRenderer.setTileMap(tileMap);\r\n       this.engine.graphics._lightDir = [0, 1, 0];\r\n\r\n       this.selectTile.setPosition(0, 50, 0);\r\n       this.selectTile.setScaleSingle(1);\r\n       this.engine.sceneGraph.addEntity(this.selectTile);\r\n   }\r\n\r\n    onUpdate(){\r\n\r\n    }\r\n\r\n    onMouseClick(x, y){\r\n        var peon = new Peon(this.engine);\r\n        peon.setPosition(this.selectTile.x + 0.5, 0, this.selectTile.z + 0.5);\r\n        this.sceneGraph.addEntity(peon);\r\n    }\r\n\r\n    onMouseMove(fromX, fromY, toX, toY) {\r\n        var x:number = ((toX * 2) / 800) - 1;\r\n        var y:number =  1 - ((toY * 2) / 600);\r\n\r\n        var ray = new Ray(x, y);\r\n        var position = ray.getYPlaneIntersection(this.engine.camera.getMatrix(), null);\r\n\r\n        this.selectTile.setPosition(position[0], 0.01, position[2]);\r\n    }\r\n\r\n    unproject(winx,winy,winz,mat,viewport){\r\n        winz = 2 * winz - 1;\r\n        var invMat = mat4.create();\r\n        mat4.invert(invMat,mat);\r\n        var n = vec4.fromValues(winx, winy, winz, 1);\r\n        vec4.transformMat4(n,n,invMat);\r\n        var n2 = vec3.fromValues(n[0]/n[3], n[1]/n[3], n[2]/n[3]);\r\n        return n2;\r\n    }\r\n};\n\n\n// WEBPACK FOOTER //\n// ./client/engine/game/scene.ts","import GameObject = require(\"../gameObject\");\r\nimport Engine = require(\"../../engine\");\r\n/**\r\n * Created by Jamie on 05-Jul-15.\r\n */\r\n\r\nclass Tile extends GameObject{\r\n    engine:Engine;\r\n\r\n    constructor(engine){\r\n        super();\r\n        this.engine = engine;\r\n\r\n        this.setMesh(engine.graphics.assetCollection.getMesh(\"square\"));\r\n        this.setTexture(engine.graphics.assetCollection.getTexture(\"selectTile\"));\r\n    }\r\n}\r\n\r\nexport = Tile;\n\n\n// WEBPACK FOOTER //\n// ./client/engine/game/entities/tile.ts","/**\r\n * Created by Jamie on 02-Jul-15.\r\n */\r\n\r\n///<reference path=\"../../lib/gl-matrix.d.ts\" />\r\nimport Mesh = require(\"../core/mesh\");\r\n\r\nclass GameObject {\r\n    mesh: Mesh.Mesh;\r\n    texture: any;\r\n    orientation: Float32Array;\r\n    visible:boolean = true;\r\n\r\n    x: number;\r\n    y: number;\r\n    z:number;\r\n\r\n    scaleX: number;\r\n    scaleY: number;\r\n    scaleZ: number;\r\n\r\n    constructor(){\r\n        this.orientation = mat4.create();\r\n        this.scaleX = 1;\r\n        this.scaleY = 1;\r\n        this.scaleZ = 1;\r\n        this.setPosition(0, 0, 0);\r\n    }\r\n\r\n    setMesh(mesh:Mesh.Mesh){\r\n        this.mesh = mesh;\r\n    }\r\n\r\n    setTexture(texture:any){\r\n        this.texture = texture;\r\n    }\r\n\r\n    getBoundingCube() : Mesh.BoundingCube{\r\n        var boundingCube = this.mesh.getBoundingCube();\r\n        return boundingCube;\r\n    }\r\n\r\n    setPosition(x: number, y:number, z:number){\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n    }\r\n\r\n    setScaleSingle(scale:number) {\r\n        this.scaleX = scale;\r\n        this.scaleY = scale;\r\n        this.scaleZ = scale;\r\n    }\r\n\r\n    setOrientation(orientation) {\r\n        this.orientation = orientation;\r\n    }\r\n\r\n    getMatrix():Float32Array {\r\n        var matrix = mat4.create();\r\n        mat4.translate(matrix, matrix, vec3.fromValues(this.x, this.y, this.z));\r\n        mat4.mul(matrix, matrix, this.orientation);\r\n\r\n        var scale = mat4.create();\r\n        mat4.scale(scale, scale, vec3.fromValues(this.scaleX, this.scaleY, this.scaleZ));\r\n        mat4.mul(matrix, matrix, scale);\r\n\r\n        return matrix;\r\n    }\r\n\r\n    update(delta){\r\n\r\n    }\r\n}\r\n\r\nexport = GameObject;\n\n\n// WEBPACK FOOTER //\n// ./client/engine/game/gameObject.ts","/**\r\n * Created by Jamie on 25-Jul-15.\r\n */\r\n\r\n\r\nimport ImageMap = require(\"../core/imageMap\");\r\n/**\r\n * Create an array of tiles with an imagemap put in\r\n * where each tile has a position, orientation and imageMap index\r\n */\r\n\r\ninterface InvalidationListener {\r\n    invalidate():void;\r\n}\r\n\r\nexport class TileMap implements InvalidationListener {\r\n\r\n    private tileLevels:TileLevel[];\r\n    private tileWidth:number;\r\n    private tileHeight:number;\r\n\r\n    private isInvalidated:boolean;\r\n    private imageMap:ImageMap;\r\n\r\n\r\n    constructor(tileWidth, tileHeight){\r\n        this.tileWidth = tileWidth;\r\n        this.tileHeight = tileHeight;\r\n\r\n        this.tileLevels = [];\r\n        this.isInvalidated = true;\r\n    }\r\n\r\n    setImageMap(imageMap:ImageMap){\r\n        this.imageMap = imageMap;\r\n    }\r\n\r\n    getImageMap():ImageMap{\r\n        return this.imageMap;\r\n    }\r\n\r\n    getTileLevels():TileLevel[]{\r\n        return this.tileLevels;\r\n    }\r\n\r\n    getTileWidth():number {\r\n        return this.tileWidth;\r\n    }\r\n\r\n    getTileHeight():number {\r\n        return this.tileHeight;\r\n    }\r\n\r\n    reset():void {\r\n        this.isInvalidated = false;\r\n    }\r\n\r\n    invalidate():void {\r\n        this.isInvalidated = true;\r\n    }\r\n}\r\n\r\nexport class TileLevel {\r\n    private tiles:TileMapTile[];\r\n    private invalidationListener:InvalidationListener;\r\n\r\n    constructor(invalidationListener:InvalidationListener){\r\n        this.tiles = [];\r\n        this.invalidationListener = invalidationListener;\r\n    }\r\n\r\n    getTiles():TileMapTile[]{\r\n        return this.tiles;\r\n    }\r\n\r\n    setTiles(tileMapTiles:TileMapTile[]){\r\n        this.tiles = tileMapTiles;\r\n        this.invalidationListener.invalidate();\r\n    }\r\n\r\n    setTile(index, tile){\r\n        this.tiles[index] = tile;\r\n        this.invalidationListener.invalidate();\r\n    }\r\n}\r\n\r\nexport class TileMapTile {\r\n    x: number;\r\n    y: number;\r\n    z: number;\r\n\r\n    imageMapIndex:number;\r\n\r\n    constructor(x, y, z){\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n\r\n        this.imageMapIndex = 0;\r\n    }\r\n\r\n    setImageMapIndex(index:number){\r\n        this.imageMapIndex = index;\r\n    }\r\n\r\n    getImageMapIndex():number{\r\n        return this.imageMapIndex;\r\n    }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./client/engine/game/tileMap.ts","import GameObject = require(\"../gameObject\");\r\nimport Engine = require(\"../../engine\");\r\n/**\r\n * Created by Jamie on 05-Jul-15.\r\n */\r\n\r\n\r\nclass Peon extends GameObject{\r\n\r\n    engine:Engine;\r\n\r\n    maxX = -100;\r\n    maxZ = -100;\r\n\r\n    direction:Float32Array;\r\n    timer = 0;\r\n    nextChange = 0;\r\n\r\n    constructor(engine){\r\n        super();\r\n        this.engine = engine;\r\n        this.setMesh(engine.graphics.assetCollection.getMesh(\"man\"));\r\n        this.setTexture(engine.graphics.assetCollection.getTexture(\"mantexture\"));\r\n        this.setScaleSingle(0.2);\r\n        this.randomOrientation();\r\n    }\r\n\r\n    randomOrientation(){\r\n        this.direction = vec2.fromValues(Math.random() * 2 -1, Math.random() * 2 -1);\r\n        vec2.normalize(this.direction, this.direction);\r\n        this.nextChange = Math.random() * 150 + 10;\r\n    }\r\n\r\n    update(){\r\n        this.timer++;\r\n        if(this.timer > this.nextChange){\r\n            this.randomOrientation();\r\n            this.timer = 0;\r\n        }\r\n\r\n        this.x += this.direction[0] * 0.01;\r\n        this.z += this.direction[1] * 0.01;\r\n\r\n        if(this.x > 50 || this.x < -50){\r\n            this.direction[0] *= -1;\r\n        }\r\n        if(this.z > 50 || this.z < -50){\r\n            this.direction[1] *= -1;\r\n        }\r\n    }\r\n}\r\n\r\nexport = Peon;\n\n\n// WEBPACK FOOTER //\n// ./client/engine/game/entities/peon.ts","/**\r\n * Created by Jamie on 02-Aug-15.\r\n */\r\n///<reference path=\"../../lib/gl-matrix.d.ts\" />\r\n\r\nclass Ray {\r\n    x:number;\r\n    y:number;\r\n\r\n    /**\r\n     * @param x The xposition of the ray in clip space\r\n     * @param y The yPosition of the ray in clip space\r\n     */\r\n    constructor(x:number, y:number){\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n\r\n    /**\r\n     * @param modelView The matrix representing the modelView\r\n     */\r\n    getInWorld(modelView:Float32Array):Float32Array{\r\n        var perspective = mat4.create();\r\n        mat4.perspective(perspective, 45, 800 / 600, 0.1, 100.0);\r\n        mat4.mul(perspective, perspective, modelView);\r\n\r\n        var mouseClipNear:Float32Array = this.unproject(this.x, this.y, -1, perspective, [0, 0, 600, 600]);\r\n        var mouseClipFar:Float32Array = this.unproject(this.x, this.y, 0, perspective, [0, 0, 600, 600]);\r\n\r\n        var dir = vec3.create();\r\n        vec3.sub(dir, mouseClipFar, mouseClipNear);\r\n        vec3.normalize(dir, dir);\r\n        return dir;\r\n    }\r\n\r\n    /**\r\n     * @param modelView The matrix representing the modelView\r\n     * @param yPosition (optional) raise the yPlane by the specified amount\r\n     */\r\n    getYPlaneIntersection(modelView:Float32Array, yPosition?:number):number[]{\r\n        var dir = this.getInWorld(modelView);\r\n        var inverseCamera = mat4.create();\r\n        mat4.invert(inverseCamera, modelView);\r\n        var cameraPosition = vec3.fromValues(inverseCamera[12], inverseCamera[13], inverseCamera[14]);\r\n        var distance = -cameraPosition[1] / dir[1];\r\n        vec3.scale(dir, dir, distance);\r\n\r\n        var roundexX = Math.floor(cameraPosition[0] + dir [0]);\r\n        var roundedZ = Math.floor(cameraPosition[2] + dir[2]);\r\n        return [roundexX, 0, roundedZ];\r\n    }\r\n\r\n    unproject(winx,winy,winz,mat,viewport){\r\n        winz = 2 * winz - 1;\r\n        var invMat = mat4.create();\r\n        mat4.invert(invMat,mat);\r\n        var n = vec4.fromValues(winx, winy, winz, 1);\r\n        vec4.transformMat4(n,n,invMat);\r\n        var n2 = vec3.fromValues(n[0]/n[3], n[1]/n[3], n[2]/n[3]);\r\n        return n2;\r\n    }\r\n}\r\n\r\nexport = Ray;\n\n\n// WEBPACK FOOTER //\n// ./client/engine/game/ray.ts","import Texture = require(\"./texture\");\r\n\r\nexport class ImageMap {\r\n    private width:number;\r\n    private height:number;\r\n    private tileHeight:number;\r\n    private tileWidth:number;\r\n    private texture:Texture;\r\n\r\n    constructor(texture:Texture, width:number, height:number, tileWidth:number, tileHeight:number){\r\n        this.width = width;\r\n        this.height = height;\r\n        this.texture = texture;\r\n\r\n        this.tileWidth = tileWidth;\r\n        this.tileHeight = tileHeight;\r\n    }\r\n\r\n    getTexture():Texture{\r\n        return this.texture;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param index\r\n     * @returns {Array} The array of the texture positions of the four corners of the tile\r\n     */\r\n    getCoordsAtIndex(index:number):number[]{\r\n        var finalWidth = index * this.tileWidth;\r\n        var x:number, y:number;\r\n\r\n        if(finalWidth >= this.width) {\r\n            var rowNum = Math.floor(finalWidth / this.width);\r\n            var offset = finalWidth % this.width;\r\n            x = offset;\r\n            y = rowNum * this.tileHeight;\r\n        } else {\r\n            x = finalWidth;\r\n            y = 0;\r\n        }\r\n\r\n\r\n        var result = [];\r\n\r\n        //bottom left\r\n        result.push(x / this.width);\r\n        result.push((y + this.tileHeight) / this.height);\r\n\r\n        //bottom right\r\n        result.push((x + this.tileWidth) / this.width);\r\n        result.push((y + this.tileHeight) / this.height);\r\n\r\n        //top right\r\n        result.push((x + this.tileWidth) / this.width);\r\n        result.push(y / this.height);\r\n\r\n        //top left\r\n        result.push(x / this.width);\r\n        result.push(y / this.height);\r\n\r\n        return result;\r\n    }\r\n\r\n    doSomething(){\r\n        return \"hi\";\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./client/engine/core/imageMap.ts","import GameObject = require(\"./gameObject\");\r\nimport DebugLine = require(\"../core/debugLine\");\r\nimport {TileMap} from \"./tileMap\";\r\nimport {Scene} from \"./scene\";\r\n/**\r\n * Created by Jamie on 28-Jun-15.\r\n */\r\n\r\n\r\n\r\nexport class Scenegraph {\r\n    graph:GameObject[];\r\n    debugGraph:DebugLine[];\r\n    transparentGraph:GameObject[];\r\n\r\n    tileMap:TileMap;\r\n    currentScene:Scene;\r\n\r\n    constructor(){\r\n        this.graph = [];\r\n        this.debugGraph = [];\r\n        this.transparentGraph = [];\r\n    }\r\n\r\n    addEntity(entity:GameObject){\r\n        this.graph.push(entity);\r\n    }\r\n\r\n    addTransparentEntity(entity:GameObject){\r\n        this.transparentGraph.push(entity);\r\n    }\r\n\r\n    setScene(scene:Scene){\r\n        this.currentScene = scene;\r\n    }\r\n\r\n    update(delta){\r\n        for(var i = 0; i < this.graph.length; i++){\r\n            this.graph[i].update(0);\r\n        }\r\n    }\r\n};\n\n\n// WEBPACK FOOTER //\n// ./client/engine/game/scenegraph.ts","///<reference path=\"../../../lib/gl-matrix.d.ts\" />\r\nimport {CameraClickBehaviour} from \"./clickBehaviour\";\r\nimport {Scenegraph} from \"../../game/scenegraph\";\r\nimport {Camera} from \"../camera\";\r\nimport {MousePosition} from \"../../input/mousePosition\";\r\nimport GameObject = require(\"../../game/gameObject\");\r\nimport {BoundingCube} from \"../../core/mesh\";\r\n\r\nexport class CameraClickPickerBehaviour implements CameraClickBehaviour {\r\n    viewportWidth:number;\r\n    viewportHeight:number;\r\n    sceneGraph:Scenegraph;\r\n    camera:Camera;\r\n\r\n    constructor(sceneGraph:Scenegraph, camera:Camera){\r\n        this.sceneGraph = sceneGraph;\r\n        this.camera = camera;\r\n    }\r\n\r\n    setViewportDimensions(width:number, height:number):void{\r\n        this.viewportWidth = width;\r\n        this.viewportHeight = height;\r\n    }\r\n\r\n    private getClipCameraPosition(position:MousePosition) : MousePosition {\r\n        var x:number = ((position.x * 2) / this.viewportWidth) - 1;\r\n        var y:number = 1.0 - ((position.y * 2) / this.viewportHeight);\r\n\r\n        return new MousePosition(x, y);\r\n    }\r\n\r\n    onClick(position:MousePosition): void {\r\n        for(var i = 0; i < this.sceneGraph.graph.length; i++){\r\n            var entity = this.sceneGraph.graph[i];\r\n            if(this.isClickOnEntity(this.getClipCameraPosition(position), entity, this.camera.getMatrix())){\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    isClickOnEntity(click:MousePosition, entity:GameObject, cameraMatrix:Float32Array){\r\n        //TODO: Figure out why ZNear has to be 1\r\n        var perspective = mat4.create();\r\n        mat4.perspective(perspective, 45, 800 / 600, 0.1, 100.0);\r\n        mat4.mul(perspective, perspective, cameraMatrix);\r\n\r\n        var mouseClipNear:Float32Array = this.unproject(click.x, click.y, -1, perspective, [0, 0, 600, 600]);\r\n        var mouseClipFar:Float32Array = this.unproject(click.x, click.y, 0, perspective, [0, 0, 600, 600]);\r\n\r\n        var dir = vec3.create();\r\n        vec3.sub(dir, mouseClipFar, mouseClipNear);\r\n        vec3.normalize(dir, dir);\r\n\r\n        var inverseCamera = mat4.create();\r\n        mat4.invert(inverseCamera, cameraMatrix);\r\n        var cameraPosition = vec3.fromValues(inverseCamera[12], inverseCamera[13], inverseCamera[14]);\r\n\r\n        var result2 = vec3.create();\r\n        vec3.copy(result2, dir);\r\n        vec3.scale(result2, result2, 100);\r\n        vec3.add(result2, cameraPosition, result2);\r\n        this.sceneGraph.currentScene.drawDebugLine(cameraPosition, result2);\r\n\r\n        var boundingCube:BoundingCube = entity.getBoundingCube();\r\n        boundingCube.transform(entity.getMatrix());\r\n        //console.log(boundingCube);\r\n\r\n        var result = this.testRayOBBIntersection(cameraPosition, dir, boundingCube);\r\n        if(result) {\r\n           console.log(\"hit\");\r\n        } else {\r\n\r\n        }\r\n\r\n    }\r\n\r\n    testRayOBBIntersection(point:Float32Array, vector:Float32Array, box:BoundingCube) {\r\n        var values = [\"x\", \"y\", \"z\"]\r\n        var tmin = 0;\r\n        var tmax = 10000000;\r\n\r\n        for (var i:number = 0; i < 3; i++) {\r\n            if (Math.abs(vector[i]) < 0.0001) {\r\n                //parallel\r\n                if (point[i] < box.lowest[i] || point[i] > box.highest[i]) {\r\n                    //console.log(\"Failed on containment check for \" + values[i]);\r\n                    return null;\r\n                }\r\n            } else {\r\n                var ood = 1.0 / vector[i];\r\n                var t1 = (box.lowest[i] - point[i]) * ood;\r\n                var t2 = (box.highest[i] - point[i]) * ood;\r\n                //console.log(\"t1 \" + t1 + \" t2 \" + t2);\r\n                if (t1 > t2) {\r\n                    //swap\r\n                    var w = t1;\r\n                    t1 = t2;\r\n                    t2 = w;\r\n                }\r\n\r\n                if (t1 > tmin) tmin = t1;\r\n                if (t2 < tmax) tmax = t2;\r\n                if (tmin > tmax) {\r\n                    //console.log(\"Failed on min check for \" + values[i]);\r\n                    //console.log(\"With tmin: \" + tmin + \" tmax: \" + tmax);\r\n                    return null;\r\n                }\r\n            }\r\n        }\r\n        var collisionPoint = vec3.create();\r\n        vec3.scale(collisionPoint, vector, tmin);\r\n        vec3.add(collisionPoint, collisionPoint, point);\r\n        return collisionPoint;\r\n    }\r\n\r\n    /* unproject - convert screen coordinate to WebGL Coordinates\r\n     *   winx, winy - point on the screen\r\n     *   winz       - winz=0 corresponds to newPoint and winzFar corresponds to farPoint\r\n     *   mat        - model-view-projection matrix\r\n     *   viewport   - array describing the canvas [x,y,width,height]\r\n     */\r\n    unproject(winx,winy,winz,mat,viewport){\r\n        winz = 2 * winz - 1;\r\n        var invMat = mat4.create();\r\n        mat4.invert(invMat,mat);\r\n        var n = vec4.fromValues(winx, winy, winz, 1);\r\n        vec4.transformMat4(n,n,invMat);\r\n        var n2 = vec3.fromValues(n[0]/n[3], n[1]/n[3], n[2]/n[3]);\r\n        return n2;\r\n    }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./client/engine/camera/behaviours/cameraClickPickerBehaviour.ts"],"sourceRoot":""}